!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexbuffdataplugin=e()}(this,function(){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(u){return function(){var t,e,n,s=o(u);if(function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}}()){var i=o(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return e=this,!(n=t)||"object"!=typeof n&&"function"!=typeof n?f(e):n}}function h(t){return void 0===t.buffs&&(t.baseValues={},t.buffs={},t.bounds={}),void 0===t.addBuff&&Object.assign(t,e),t}var c=function(){function t(){u(this,t),this.buffs={}}return r(t,[{key:"setEnable",value:function(t,e){return void 0===e&&(e=!0),this.buffs.hasOwnProperty(t)||(this.buffs[t]={enable:!0,value:0,type:l}),this.buffs[t].enable=e,this}},{key:"set",value:function(t,e){this.setEnable(t);var n=i(e);"number"===n?n=l:"string"===n&&(e=-1!==e.indexOf("%")?(n=b,parseFloat(e)/100):(n=l,parseFloat(e)));var s=this.buffs[t];return s.value=e,s.type=n,this}},{key:"remove",value:function(t){return this.buffs.hasOwnProperty(t)&&delete this.buffs[t],this}},{key:"buff",value:function(t){var e,n,s=t,i=this.buffs;for(var u in i)if((e=i[u]).enable)switch(n=e.type,e=e.value,n){case l:s+=e;break;case b:s+=t*e}return s}}]),t}(),l=0,b=1,y=Phaser.Utils.Objects.IsPlainObject,p=Phaser.Utils.Objects.GetValue,d=function(){function s(t,e){if(u(this,s),y(t)){var n=t;t=p(n,"min",void 0),e=p(n,"max",void 0)}this.setMin(t),this.setMax(e)}return r(s,[{key:"setMin",value:function(t){return this.min=t,this}},{key:"setMax",value:function(t){return this.max=t,this}},{key:"clamp",value:function(t){return void 0!==this.min&&t<this.min?t=this.min:void 0!==this.max&&t>this.max&&(t=this.max),t}}]),s}(),e={setBaseValue:function(t,e){return this.baseValues[t]=e,this.set(t,this.getBuffResult(t)),this},removeBaseValue:function(t){return this.baseValues.hasOwnProperty(t)&&(delete this.baseValues[t],this.remove(t)),this},setBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new c),this.buffs[t].set(e,n),this.set(t,this.getBuffResult(t)),this},enableBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new c),this.buffs[t].setEnable(e,n),this.set(t,this.getBuffResult(t)),this},removeBuff:function(t,e){return this.buffs.hasOwnProperty(t)&&(void 0===e?delete this.buffs[t]:this.buffs[t].remove(e)),this.set(t,this.getBuffResult(t)),this},setMin:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e),this.set(t,this.getBuffResult(t)),this},setMax:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMax(e),this.set(t,this.getBuffResult(t)),this},setBounds:function(t,e,n){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e).setMax(n),this.set(t,this.getBuffResult(t)),this},getBuffResult:function(t){return this.clamp(t,this.buff(t))},buff:function(t,e){return void 0===e&&(e=this.getBaseValue(t)),this.buffs.hasOwnProperty(t)?this.buffs[t].buff(e):e},clamp:function(t,e){return void 0===e&&(e=this.list[t]),this.bounds.hasOwnProperty(t)?this.bounds[t].clamp(e):e},getBaseValue:function(t){return this.baseValues.hasOwnProperty(t)||(this.baseValues[t]=0),this.baseValues[t]},getBuffs:function(t,e){var n=this.buffs[t];return void 0===e?n:n&&n.hasOwnProperty(e)?n[e]:void 0},getBounds:function(t){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t]}},v=Phaser.Data.DataManager,m=Phaser.Events.EventEmitter,w=function(){t(i,v);var s=a(i);function i(t,e){var n;return u(this,i),void 0===e&&(e=new m),n=s.call(this,t,e),h(f(n)),n}return i}();return Object.assign(w.prototype,e),function(){t(n,Phaser.Plugins.BasePlugin);var e=a(n);function n(t){return u(this,n),e.call(this,t)}return r(n,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new w(t,e)}},{key:"extend",value:function(t){return h(t)}}]),n}()});
